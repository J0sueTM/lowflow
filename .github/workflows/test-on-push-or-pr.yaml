name: test-on-push-or-pr
on:
  push:
  pull_request:
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5

      - name: Build makefiles with premake
        uses: eariassoto/setup-premake@v1
        with:
          version: '5.0.0-beta1'
          action: 'gmake'
          options: '--cc=gcc'

      - name: Install GCC
        uses: egor-tensin/setup-gcc@v1
        with:
          version: latest
          platform: x64

      - name: Build tests
        run: make tests

      - name: Run tests
        run: ./bin/tests/dbg/tests --seed ${{ github.run_id }}
